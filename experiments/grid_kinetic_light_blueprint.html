<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaisu - Kinetic Blueprint (Light)</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #f8fafc;
            --primary: #2563eb;
            --accent: #db2777;
            --neutral: #94a3b8;
            --border: #e2e8f0;
        }
        body { 
            background: var(--bg); 
            color: #0f172a; 
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden;
        }
        .kinetic-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 40px;
            position: relative;
            z-index: 10;
        }
        .connection-path {
            fill: none;
            stroke: var(--neutral);
            stroke-width: 1.5;
            opacity: 0.15;
            transition: all 0.4s ease;
        }
        .connection-path.active {
            stroke: var(--primary);
            stroke-width: 2.5;
            opacity: 0.8;
            stroke-dasharray: 8 8;
            animation: flow 1s linear infinite;
        }
        .connection-path.related {
            stroke: var(--accent);
            opacity: 0.4;
            stroke-width: 2;
        }
        @keyframes flow {
            from { stroke-dashoffset: 16; }
            to { stroke-dashoffset: 0; }
        }
        .card-node {
            background: #ffffff;
            border: 1px solid var(--border);
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .card-node:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(37, 99, 235, 0.1);
        }
        .card-active {
            border-color: var(--primary) !important;
            border-width: 2px;
            background: #f0f7ff;
        }
        .card-dimmed {
            opacity: 0.4;
            filter: grayscale(0.5);
        }
        .path-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            font-weight: 700;
            text-transform: uppercase;
            fill: var(--primary);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .path-label.visible { opacity: 1; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo, useRef, useEffect } = React;

        const DATA = {
            entities: [
                { id: "e1", text: "Cloud Architecture Strategy", type: "ROOT", group: 0 },
                { id: "e2", text: "AWS Infrastructure", type: "ORG", group: 1 },
                { id: "e4", text: "Webflow Engine", type: "PLATFORM", group: 1 },
                { id: "e9", text: "Framer Design", type: "PLATFORM", group: 1 },
                { id: "e11", text: "WordPress Core", type: "LEGACY", group: 2 },
                { id: "e7", text: "SEO Capabilities", type: "FEATURE", group: 2 },
                { id: "e23", text: "Cost Stream: $29/mo", type: "METRIC", group: 3 },
                { id: "e25", text: "Entry Level: $5/mo", type: "METRIC", group: 3 }
            ],
            links: [
                { id: "l1", source: "e1", target: "e2", label: "RELATES_TO" },
                { id: "l2", source: "e1", target: "e4", label: "USES" },
                { id: "l3", source: "e1", target: "e9", label: "USES" },
                { id: "l4", source: "e4", target: "e7", label: "FEATURES" },
                { id: "l5", source: "e4", target: "e23", label: "REQUIRES" },
                { id: "l6", source: "e9", target: "e25", label: "REQUIRES" }
            ]
        };

        const App = () => {
            const [active, setActive] = useState(null);
            const [coords, setCoords] = useState({});
            const cardRefs = useRef({});

            const updateCoords = () => {
                const newCoords = {};
                DATA.entities.forEach(e => {
                    const el = cardRefs.current[e.id];
                    if (el) {
                        const rect = el.getBoundingClientRect();
                        newCoords[e.id] = {
                            x: rect.left + rect.width / 2,
                            y: rect.top + rect.height / 2,
                            w: rect.width,
                            h: rect.height
                        };
                    }
                });
                setCoords(newCoords);
            };

            useEffect(() => {
                updateCoords();
                window.addEventListener('resize', updateCoords);
                return () => window.removeEventListener('resize', updateCoords);
            }, []);

            const neighbors = useMemo(() => {
                if (!active) return new Set();
                const set = new Set();
                DATA.links.forEach(l => {
                    if (l.source === active) set.add(l.target);
                    if (l.target === active) set.add(l.source);
                });
                return set;
            }, [active]);

            return (
                <div className="p-20 relative min-h-screen">
                    <header className="mb-20 flex justify-between items-start">
                        <div>
                            <h1 className="text-4xl font-black tracking-tight flex items-center gap-4 text-slate-900">
                                <span className="w-10 h-10 rounded-xl bg-blue-600 flex items-center justify-center text-xl text-white shadow-xl shadow-blue-100">B</span>
                                KINETIC_BLUEPRINT
                            </h1>
                            <p className="text-slate-400 font-mono text-[10px] mt-2 uppercase tracking-[0.3em]">Light Mode Persistent Connection Protocol</p>
                        </div>
                        <div className="bg-white px-6 py-3 rounded-2xl border border-slate-200 flex gap-10">
                            <div className="flex items-center gap-2">
                                <div className="w-2 h-2 rounded-full bg-blue-600" />
                                <span className="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Active Source</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-2 h-2 rounded-full bg-pink-500" />
                                <span className="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Related Node</span>
                            </div>
                        </div>
                    </header>

                    {/* SVG Layer for Connections */}
                    <svg className="fixed inset-0 w-full h-full pointer-events-none z-0 overflow-visible">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="currentColor" />
                            </marker>
                        </defs>
                        {DATA.links.map(l => {
                            const s = coords[l.source];
                            const t = coords[l.target];
                            if (!s || !t) return null;

                            const isActive = active === l.source || active === l.target;
                            const dx = t.x - s.x;
                            const dy = t.y - s.y;
                            
                            // Create a nice curve: control points offset based on distance
                            const midX = (s.x + t.x) / 2;
                            const midY = (s.y + t.y) / 2;
                            const cp1x = s.x + dx * 0.25;
                            const cp1y = s.y;
                            const cp2x = t.x - dx * 0.25;
                            const cp2y = t.y;

                            const d = `M ${s.x} ${s.y} C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${t.x} ${t.y}`;

                            return (
                                <g key={l.id}>
                                    <path 
                                        d={d} 
                                        className={`connection-path ${isActive ? 'active' : ''}`}
                                        style={{ color: isActive ? '#2563eb' : '#94a3b8' }}
                                    />
                                    {isActive && (
                                        <text className="path-label visible">
                                            <textPath href={`#path-${l.id}`} startOffset="50%" textAnchor="middle">
                                                {l.label}
                                            </textPath>
                                        </text>
                                    )}
                                    {/* Invisible path for text alignment */}
                                    <path id={`path-${l.id}`} d={d} fill="none" />
                                    
                                    {/* Connection Label along the curve */}
                                    {isActive && (
                                        <g transform={`translate(${midX}, ${midY - 10})`}>
                                            <rect x="-40" y="-8" width="80" height="16" rx="8" fill="white" stroke="#e2e8f0" strokeWidth="1" />
                                            <text textAnchor="middle" className="text-[8px] font-bold fill-blue-600 font-mono uppercase" y="3">{l.label}</text>
                                        </g>
                                    )}
                                </g>
                            );
                        })}
                    </svg>

                    <div className="kinetic-grid">
                        {[0, 1, 2, 3].map(group => (
                            <div key={group} className="flex flex-col gap-8">
                                <div className="text-[10px] font-black text-slate-300 uppercase tracking-[0.4em] mb-2 border-b border-slate-100 pb-2">Layer_0{group}</div>
                                {DATA.entities.filter(e => e.group === group).map(e => {
                                    const isSelected = active === e.id;
                                    const isRelated = neighbors.has(e.id);
                                    const isDimmed = active && !isSelected && !isRelated;

                                    return (
                                        <div 
                                            key={e.id}
                                            ref={el => cardRefs.current[e.id] = el}
                                            onClick={() => setActive(isSelected ? null : e.id)}
                                            className={`card-node rounded-3xl p-8 cursor-pointer relative ${isSelected ? 'card-active' : ''} ${isDimmed ? 'card-dimmed scale-95' : ''}`}
                                        >
                                            <div className="flex justify-between items-start mb-4">
                                                <span className="text-[9px] font-mono text-slate-400 font-bold bg-slate-50 px-2 py-1 rounded">UID_{e.id}</span>
                                                <div className={`w-3 h-3 rounded-full border-2 border-white ${isSelected ? 'bg-blue-600 shadow-lg shadow-blue-200 animate-pulse' : isRelated ? 'bg-pink-500 shadow-lg shadow-pink-100' : 'bg-slate-100'}`} />
                                            </div>
                                            <div className="font-bold text-xl leading-tight text-slate-800 mb-6">{e.text}</div>
                                            <div className="flex items-center gap-2">
                                                <span className="text-[10px] px-3 py-1 rounded-full bg-slate-100 text-slate-500 font-black uppercase tracking-tighter">{e.type}</span>
                                                {isSelected && (
                                                    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="flex items-center gap-1">
                                                        <div className="w-1 h-1 rounded-full bg-blue-600" />
                                                        <span className="text-[9px] font-bold text-blue-600 uppercase">Focusing Signal</span>
                                                    </motion.div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        ))}
                    </div>

                    {/* Bottom Guide */}
                    <div className="fixed bottom-10 left-1/2 -translate-x-1/2 glass px-8 py-4 rounded-full border border-slate-200 bg-white/80 backdrop-blur-md shadow-xl flex items-center gap-6">
                        <div className="flex items-center gap-3">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#2563eb" strokeWidth="2.5"><circle cx="12" cy="12" r="10"/><path d="m12 8 4 4-4 4M8 12h8"/></svg>
                            <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Select Card to Analyze Connection Rationale</span>
                        </div>
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>